--- a/src/d8/d8.cc	2026-02-15 00:21:17.038742391 +0000
+++ b/src/d8/d8.cc	2026-02-15 00:21:59.429730978 +0000
@@ -355,6 +355,38 @@
 v8::Platform* g_default_platform;
 std::unique_ptr<v8::Platform> g_platform;
 
+// ---- maglev-warmup challenge helpers ----
+
+static void WinMaglevObserved(const v8::FunctionCallbackInfo<v8::Value>& info) {
+  v8::Isolate* isolate = info.GetIsolate();
+  if (info.Length() != 2) {
+    isolate->ThrowError(
+        "WinMaglevObserved(maglev_status, turbofan_status): expected 2 numbers");
+    return;
+  }
+  if (!info[0]->IsNumber() || !info[1]->IsNumber()) {
+    isolate->ThrowError("WinMaglevObserved: both arguments must be numbers");
+    return;
+  }
+  v8::Local<v8::Context> ctx = isolate->GetCurrentContext();
+  uint32_t maglev_status = info[0]->Uint32Value(ctx).FromJust();
+  uint32_t turbofan_status = info[1]->Uint32Value(ctx).FromJust();
+  // OptimizationStatus bits (from runtime.h):
+  //   bit 4 (0x10) = kOptimized  (TurboFan)
+  //   bit 5 (0x20) = kMaglevved
+  if (!(maglev_status & 0x20)) {
+    isolate->ThrowError(
+        "WinMaglevObserved: first status doesn't have Maglev bit (0x20) set");
+    return;
+  }
+  if (!(turbofan_status & 0x10)) {
+    isolate->ThrowError(
+        "WinMaglevObserved: second status doesn't have TurboFan bit (0x10) set");
+    return;
+  }
+  (void)system("/challenge/catflag");
+}
+
 template <int N>
 bool ThrowError(Isolate* isolate, const char (&message)[N]) {
   if (isolate->IsExecutionTerminating()) return false;
@@ -3358,7 +3390,9 @@
 
 Local<ObjectTemplate> Shell::CreateGlobalTemplate(Isolate* isolate) {
   Local<ObjectTemplate> global_template = ObjectTemplate::New(isolate);
-  global_template->Set(Symbol::GetToStringTag(isolate),
+  global_template->Set(isolate, "WinMaglevObserved",
+                       FunctionTemplate::New(isolate, WinMaglevObserved));
+/*  global_template->Set(Symbol::GetToStringTag(isolate),
                        String::NewFromUtf8Literal(isolate, "global"));
   global_template->Set(isolate, "version",
                        FunctionTemplate::New(isolate, Version));
@@ -3379,13 +3413,13 @@
   global_template->Set(isolate, "readline",
                        FunctionTemplate::New(isolate, ReadLine));
   global_template->Set(isolate, "load",
-                       FunctionTemplate::New(isolate, ExecuteFile));
+                       FunctionTemplate::New(isolate, ExecuteFile));*/
   global_template->Set(isolate, "setTimeout",
                        FunctionTemplate::New(isolate, SetTimeout));
   // Some Emscripten-generated code tries to call 'quit', which in turn would
   // call C's exit(). This would lead to memory leaks, because there is no way
   // we can terminate cleanly then, so we need a way to hide 'quit'.
-  if (!options.omit_quit) {
+/*  if (!options.omit_quit) {
     global_template->Set(isolate, "quit", FunctionTemplate::New(isolate, Quit));
   }
   global_template->Set(isolate, "testRunner",
@@ -3411,7 +3445,7 @@
   if (i::v8_flags.expose_async_hooks) {
     global_template->Set(isolate, "async_hooks",
                          Shell::CreateAsyncHookTemplate(isolate));
-  }
+  }*/
 
   return global_template;
 }
