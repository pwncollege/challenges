# V8 Exploitation Challenges — Gap Analysis

**Date:** 2026-02-14
**Branch:** `wip/v8`
**Analyst:** Automated deep review of all 50 challenges

---

## 1. Complete Inventory

### Overview

| Metric | Count |
|--------|-------|
| Total challenges | 50 |
| Base levels (1–9) | 9 |
| Sub-levels / bridges | 31 |
| CVE challenges (educational) | 5 |
| CVE challenges (real version) | 5 |
| Writeups (WRITEUP.md) | 50/50 |
| Public tests | 50/50 |
| Private tests | 50/50 |

### V8 Versions Used

| V8 Revision | Challenges |
|-------------|-----------|
| `5a2307d0` (common/REVISION, via REVISION.j2) | Levels 1–6j, cve-2021-21225 (26 challenges) |
| `f5e412a1` (hardcoded REVISION) | Levels 7e–9d, cve-2020-6418, cve-2020-16040, cve-2023-2033, cve-2024-2887 (19 challenges) |
| Various original vulnerable commits | 5 CVE "-real" challenges |

### Section A: V8 Heap Exploitation Primitives (Levels 1–6)

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-1 | Direct shellcode execution via `ArrayRun()` builtin | `ArrayRun` | 137 lines |
| level-1a | Guided ArrayBuffer layout warmup | `GetAddressOf`, `GetArrayBufferBackingStoreOffset`, `ArbRead32`, `ArbWrite32`, `AllocRWX`, `CallRWX` | 165 lines |
| level-1b | Heap navigation + backing_store pivot | `GetAddressOf`, `ArbRead32`, `ArbWrite32`, `AllocRWX`, `CallRWX` (no offset helper) | 156 lines |
| level-1c | ROP primer with libc helper | `GetAddressOf`, `ArbRead32`, `ArbWrite32`, `GetLibcBase` | 142 lines |
| level-2 | Arbitrary heap R/W primitives | `GetAddressOf`, `ArbRead32`, `ArbWrite32` | 124 lines |
| level-2b | Fake object construction with ArbRead32 | `GetAddressOf`, `ArbRead32`, `GetFakeObject` | ~120 lines |
| level-3 | Addrof/Fakeobj primitive pair | `GetAddressOf`, `GetFakeObject` only | 102 lines |
| level-3b | OOB with address-guided search | `GetAddressOf`, `GetFakeObject` | ~100 lines |
| level-4 | `setLength()` OOB primitive (Torque builtin) | `GetAddressOf` only | ~90 lines |
| level-5 | Off-by-one to full OOB | `ArrayOffByOne` builtin | ~85 lines |
| level-6 | Callback TOCTOU via `functionMap` | `ArrayFunctionMap` builtin | ~110 lines |

### Section B: JIT Bugs on the V8 Heap (Levels 6-warmup – 7e)

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-6-warmup | Deterministic JIT + element-kind confusion | `GetAddressOf`, `GetFixedDoubleArrayMap` | ~100 lines |
| level-6a | Easy JIT + easy heap | `GetAddressOf` | ~80 lines |
| level-6b | Deterministic JIT + blind heap | None | ~75 lines |
| level-6c | Natural JIT warmup + addrof | `GetAddressOf` | ~80 lines |
| level-7 | Natural JIT + blind heap capstone | None | ~75 lines |
| level-7e | Reflect.construct + Proxy side-effect | None (Proxy/Reflect are native) | ~65 lines |

### Section C: CVE-2021-21225 Chain (Concat Re-Entrancy)

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-6e | WASM RWX shellcode primer | `ArrayOob` builtin | 156 lines |
| level-6d | Concat fast-path re-entrancy proof lab | Modified concat + counter | 137 lines |
| cve-2021-21225 | Array.concat OOB via callback re-entrancy | Simplified on common V8 | ~65 lines |
| cve-2021-21225-real | Same CVE on original vulnerable V8 | Minimal patch | ~35 lines |

### Section D: Garbage Collection Internals

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-6f-warmup | GC observation lab (NewSpace→OldSpace, WeakRef) | `GetAddressOf`, GC observers | 138 lines |
| level-6g | GC-triggered UAF proof lab | `ArrayOob`, `GetAddressOf` | 174 lines |
| level-6h | GC exploitation capstone (UAF + unsorted bin + libc ROP) | `ArrayOob`, `GetAddressOf` | 165 lines |

### Section E: V8 Debugging Challenges

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-6i | `%DebugPrint()` offset discovery | `ArrayOob`, native syntax | 213 lines |
| level-6j | JIT optimization trace (`%OptimizeFunctionOnNextCall`) | Simplified lowering changes | 83 lines |

### Section F: JIT Bugs on the Malloc Heap (Levels 7-warmup – 8c)

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-7-warmup | DataView OOB + BackingStore deleter layout | `GetLibcBase`, 3 offset helpers | ~100 lines |
| level-7a | DataView OOB with libc helper | `GetLibcBase`, offset helpers | ~95 lines |
| level-7b | Unsorted bin leak with synchronous GC | `GarbageCollect` | ~90 lines |
| level-7c-warmup | Async-GC reliability (WeakRef/weak-callback) | Bounds bypass | ~85 lines |
| level-7c | Unsorted bin leak with async GC | Bounds bypass | ~80 lines |
| level-7d | Subtle bounds bug with synchronous GC | `GarbageCollect` | ~80 lines |
| level-8 | Subtle bounds bug with async GC | None | ~75 lines |
| level-8c | Typer mismatch arithmetic proof lab | Typer hardening disabled | ~70 lines |

### Section G: CVE-2020-6418 Chain (TurboFan Type Confusion)

| Challenge | Concept | Patch Size |
|-----------|---------|------------|
| cve-2020-6418 | TurboFan type confusion via side-effect modeling | ~48 lines |
| cve-2020-6418-real | Same on original vulnerable V8 | ~40 lines |

### Section H: CVE-2020-16040 Chain (Integer Overflow)

| Challenge | Concept | Patch Size |
|-----------|---------|------------|
| cve-2020-16040 | Simplified lowering integer overflow | ~65 lines |
| cve-2020-16040-real | Same on original vulnerable V8 | ~60 lines |

### Section I: Escaping the V8 Sandbox (Levels 8-warmup – 9d)

| Challenge | Concept | Helpers Provided | Patch Size |
|-----------|---------|-----------------|------------|
| level-8-warmup | Guided WASM `memory_start` pivot | Offset helpers, libc helper | 388 lines |
| level-8a | Sandbox intro with libc helper | `GetLibcBase`, WASM infra | 372 lines |
| level-8b | Sandbox pivot with d8 base helper | Offset helpers | 376 lines |
| level-9 | Full sandbox escape, no helpers | WASM infra only | 351 lines |

### Section J: CVE-2023-2033 Chain (WasmIndirectFunctionTable)

| Challenge | Concept | Patch Size |
|-----------|---------|------------|
| level-9a | Regexp bytecode bridge | 526 lines |
| level-9c | GOT-overwrite bridge | 147 lines |
| cve-2023-2033 | WasmIndirectFunctionTable raw pointer corruption | 351 lines |
| cve-2023-2033-real | Same on original vulnerable V8 | ~36 lines |

### Section K: CVE-2024-2887 Chain (GSAB Underflow)

| Challenge | Concept | Patch Size |
|-----------|---------|------------|
| level-9b | GSAB underflow bridge | 496 lines |
| level-9d | WASM RWX hunting / jump-table patch | 147 lines |
| cve-2024-2887 | Pwn2Own 2024 GSAB underflow sandbox escape | 351 lines |
| cve-2024-2887-real | Same on original vulnerable V8 | ~37 lines |

---

## 2. Difficulty Progression Analysis

### Learning Curve Map

```
Phase 1: Heap Primitives        Phase 2: JIT on V8 Heap
─────────────────────────       ──────────────────────────
level-1  ●○○○○○○○○○            level-6-warmup  ●●●●○○○○○○
level-1a ●●○○○○○○○○            level-6a        ●●●●●○○○○○
level-1b ●●●○○○○○○○            level-6b        ●●●●●●○○○○
level-1c ●●●○○○○○○○            level-6c        ●●●●●●○○○○
level-2  ●●●●○○○○○○            level-7         ●●●●●●●○○○
level-2b ●●●●○○○○○○            level-7e        ●●●●●●●○○○
level-3  ●●●●●○○○○○
level-3b ●●●●●○○○○○            Phase 3: JIT on Malloc Heap
level-4  ●●●●●●○○○○            ──────────────────────────
level-5  ●●●●●●○○○○            level-7-warmup  ●●●●●●○○○○
level-6  ●●●●●●●○○○            level-7a        ●●●●●●●○○○
                                level-7b        ●●●●●●●○○○
GC Internals                    level-7c-warmup ●●●●●●●○○○
──────────────                  level-7c        ●●●●●●●●○○
level-6f-warmup ●●●●○○○○○○     level-7d        ●●●●●●●●○○
level-6g        ●●●●●●○○○○     level-8         ●●●●●●●●○○
level-6h        ●●●●●●●○○○     level-8c        ●●●●●●●●●○

Phase 4: Sandbox Escape         CVE Challenges
──────────────────────          ──────────────
level-8-warmup  ●●●●●●●○○○     cve-2021-21225      ●●●●●●●●○○
level-8a        ●●●●●●●●○○     cve-2021-21225-real ●●●●●●●●●○
level-8b        ●●●●●●●●○○     cve-2020-6418       ●●●●●●●●○○
level-9         ●●●●●●●●●○     cve-2020-6418-real  ●●●●●●●●●○
level-9a/9c     ●●●●●●●●●○     cve-2020-16040      ●●●●●●●●○○
cve-2023-2033   ●●●●●●●●●●     cve-2020-16040-real ●●●●●●●●●○
level-9b/9d     ●●●●●●●●●○     cve-2023-2033       ●●●●●●●●●●
cve-2024-2887   ●●●●●●●●●●     cve-2024-2887       ●●●●●●●●●●
```

### Identified Difficulty Cliffs

**Cliff 1: level-5 → level-6 (MODERATE)**
- level-5 introduces OOB via an explicit `offByOne` builtin
- level-6 introduces callback-based TOCTOU with `functionMap` — a fundamentally different bug class
- The bridge challenges (6-warmup, 6a) exist but appear AFTER level-6 in module.yml ordering (see ordering issue below)

**Cliff 2: level-6j → level-7-warmup (MODERATE)**
- Students transition from V8 heap exploitation to malloc heap exploitation
- level-7-warmup exists and provides helpful offset helpers, but the conceptual jump to `BackingStore` C++ objects on the malloc heap is significant
- Mitigated by the warmup challenge but could use more explanation

**Cliff 3: level-8 → level-8-warmup → level-8a (MILD)**
- Sandbox introduction is well-scaffolded with the warmup level
- The WASM `memory_start` pivot concept is new but guided

**Cliff 4: level-9 → level-9a (MODERATE)**
- level-9 is a full sandbox escape with no helpers
- level-9a jumps to regexp bytecode corruption — a completely different technique
- Bridge challenges (9a, 9b, 9c, 9d) help, but each introduces a distinct new attack surface

### Module.yml Ordering Issue

The current `module.yml` ordering does not match a strict difficulty progression. The challenges are grouped by **topic** rather than **difficulty**:

```
Section headers in module.yml order:
1. "V8 Heap Exploitation Primitives" (levels 1–6, then 6e, 6d, cve-2021-21225)
2. "JIT Bugs on the V8 Heap" (6-warmup, 6a–6c, 7, 7e, cve-2020-6418)
3. "Garbage Collection Internals" (6f-warmup, 6g, 6h)
4. "V8 Debugging Challenges" (6i, 6j)
5. "JIT Bugs on the Malloc Heap" (7-warmup, 7a–7d, 8, 8c, cve-2020-16040)
6. "Escaping the V8 Sandbox" (8-warmup, 8a–8b, 9, 9a–9d, cve-2023-2033, cve-2024-2887)
```

This is **pedagogically reasonable** (topic-based grouping) but creates some confusion:
- level-6-warmup appears AFTER level-6 in the listing, but is meant to prepare for 6a (a different topic section)
- GC challenges (6f-warmup, 6g, 6h) use the same `ArrayOob` builtin as level-6e but are in a separate section
- level-7 appears in "JIT Bugs on the V8 Heap" section, while level-7-warmup opens "JIT Bugs on the Malloc Heap"

---

## 3. Topic Coverage Analysis

### What IS Covered (with quality assessment)

| Topic | Coverage | Quality | Challenges |
|-------|----------|---------|------------|
| V8 object model (maps, elements kinds) | Excellent | Deep, hands-on | 1a, 6-warmup, 6a–6c |
| Pointer compression / cage | Excellent | Thorough | 1a, 1b, 2, 2b, 3 |
| Addrof / Fakeobj primitives | Excellent | Well-scaffolded | 2b, 3, 3b |
| OOB read/write | Excellent | Multiple approaches | 4, 5, 6e, 7-warmup |
| JIT compilation (TurboFan/Turboshaft) | Excellent | Deterministic + natural warmup | 6-warmup through 7 |
| Type confusion via JIT | Good | CVE-based | cve-2020-6418, level-7e |
| Bounds check elimination bugs | Good | Simplified lowering focus | 7-warmup through 8, cve-2020-16040 |
| Garbage collection exploitation | Excellent | Unique strength | 6f-warmup, 6g, 6h, 7b, 7c |
| UAF via GC | Good | Multiple GC modes (sync/async) | 6g, 6h, 7b, 7c |
| Unsorted bin leak (glibc) | Good | With and without helpers | 7b, 7c, 6h |
| Callback re-entrancy | Good | Concat and functionMap | 6, 6d, cve-2021-21225 |
| WASM RWX shellcode | Good | Primer + applied | 6e, 8-warmup, 8a |
| V8 sandbox escape | Good | `memory_start` pivot path | 8-warmup through 9 |
| Sandbox GOT overwrite | Good | Bridge challenge | 9c |
| Regexp bytecode corruption | Good | Bridge for cve-2023-2033 | 9a |
| GSAB underflow | Good | Bridge for cve-2024-2887 | 9b |
| ROP chain construction | Excellent | From primer to capstone | 1c, 6h, 7a, 8a |
| V8 debugging (`%DebugPrint`, etc.) | Unique | Not seen elsewhere | 6i, 6j |
| BackingStore deleter corruption | Good | Malloc heap focus | 7-warmup, 7a |
| Real CVE exploitation | Excellent | 5 CVEs, 2 variants each | 10 challenges |

### What is NOT Covered (Gaps)

#### GAP 1: Maglev Compiler Exploitation — HIGH PRIORITY

**Current state:** Zero challenges target V8's Maglev compiler. All JIT challenges target TurboFan/Turboshaft via `simplified-lowering.cc` or `node-properties.cc` patches.

**Why it matters:** Maglev has become the most actively exploited compiler tier in V8 since 2024:
- **CVE-2024-0517**: OOB write via Maglev's allocation folding (`BuildAllocateFastObject` with uninitialized `current_raw_allocation_`). Exodus Intelligence published a detailed writeup.
- **CVE-2024-4947**: Maglev type confusion via incorrect `AccessInfo` for module namespace objects. Exploited in the wild.
- **CVE-2025-6554**: Failed de-optimization when object shapes are altered in Maglev.

Maglev's graph-based SSA architecture differs fundamentally from TurboFan's sea-of-nodes, so students trained only on TurboFan miss an entire class of bugs. Matteo Malvica's blog post "An Introduction to Chrome Exploitation — Maglev Edition" provides a pedagogical template.

**Recommendation:** Add at least 2 challenges:
1. `level-6k` or similar: Maglev warmup — introduce Maglev compilation, observe differences from TurboFan
2. `cve-2024-0517` + `cve-2024-0517-real`: Maglev allocation folding OOB write

#### GAP 2: Modern Sandbox Escape Techniques — HIGH PRIORITY

**Current state:** All sandbox escape challenges use the same fundamental technique: corrupting WASM `memory_start` to pivot to arbitrary memory, then using ROP or GOT overwrite for code execution. This is explicitly noted in writeups as targeting an older V8 build where `memory_start` was unsandboxed.

**Why it matters:** V8's sandbox has been significantly hardened since mid-2024. The `memory_start` field is now protected. Current sandbox escape research (catalogued in the [V8 sandbox bypass collection](https://github.com/xv0nfers/V8-sbx-bypass-collection) with 100+ issues) uses fundamentally different techniques:

1. **Trusted Pointer Table / Code Pointer Table attacks**: Writing 64-bit values to trusted pointer table entries and faking `WasmExportedFunctionData` instances (HITCON 2024 research).
2. **Regexp bytecode modification for stack OOB**: Modifying regexp bytecodes in trusted memory to achieve stack OOB writes via register operations. Level-9a introduces this concept but doesn't cover the full technique.
3. **WASM JSPI (JavaScript Promise Integration) stack switching**: Abusing WASM central stack confusion to control SP/PC (2025 vulnerability, SSD Disclosure).
4. **API Object / Blink bridge corruption**: Type confusion in V8 "API objects" (wrappers for DOM objects) — a cross-component attack requiring V8-Blink boundary understanding.

**Recommendation:** Add 2–3 challenges covering post-2024 sandbox escape primitives:
1. A challenge using Trusted Pointer Table corruption
2. A challenge demonstrating a regexp-bytecode full chain (extending level-9a to a complete exploit)
3. A challenge covering WASM JSPI-based attacks (if V8 JSPI stabilizes)

#### GAP 3: Sparkplug and Compilation Pipeline Completeness — MEDIUM PRIORITY

**Current state:** The curriculum covers TurboFan (top-tier optimizing compiler) thoroughly. Maglev is missing (see Gap 1). Sparkplug (baseline compiler) is not covered at all.

**Why it matters:** V8's compilation pipeline is:
```
Ignition (interpreter) → Sparkplug (baseline) → Maglev (mid-tier) → TurboFan/Turboshaft (top-tier)
```

Students understand TurboFan but don't see how bugs can arise at earlier pipeline stages. Sparkplug bugs are rarer but understanding the full pipeline is valuable for variant analysis.

**Recommendation:** Add 1 challenge or at minimum a detailed reference document explaining the full pipeline. A Sparkplug challenge is optional but a Maglev challenge (Gap 1) is essential.

#### GAP 4: Vulnerability Discovery Methodology — MEDIUM PRIORITY

**Current state:** All 50 challenges provide a pre-patched vulnerability. Students learn to exploit but never to discover.

**Why it matters:** Exodus Intelligence and RET2 Systems both cover vulnerability discovery. Google's Fuzzilli fuzzer is the standard tool for JS engine bug finding. Variant analysis (finding related bugs after disclosure) is a practical skill.

**Recommendation:** Add 1–2 challenges:
1. A "diff analysis" challenge where students are given a V8 security patch and must identify the vulnerability from the fix
2. A "variant analysis" challenge where students are given one bug and must find a related bug in nearby code

These don't require fuzzing infrastructure and can be structured as analysis challenges rather than exploitation challenges.

#### GAP 5: Chrome Process Sandbox (OS-Level) — MEDIUM-LOW PRIORITY

**Current state:** All challenges operate within `d8` (V8's standalone shell). The Chrome renderer process sandbox (seccomp-bpf, namespace isolation, Mojo IPC) is never addressed.

**Why it matters:** A complete Chrome exploit chain requires:
1. V8 exploit → renderer code execution (covered thoroughly)
2. Renderer sandbox escape via Mojo IPC or kernel bug (not covered)

**Recommendation:** This is arguably out of scope for a "V8 Exploitation" module. However, a reference document or a single challenge demonstrating the concept of process-level sandboxing would provide valuable context. Consider adding it as a capstone description/reference rather than a full challenge.

#### GAP 6: Hardware Mitigations (CFI/CET) — LOW PRIORITY

**Current state:** Not addressed. ROP chains work unhindered in all challenges.

**Why it matters:** Intel CET (shadow stacks) and V8's Clang CFI are being deployed to stable Chrome. Future exploits must account for these.

**Recommendation:** A single advanced challenge or reference document addressing how CET/CFI affect ROP chain construction. Low priority because these mitigations don't change the vulnerability discovery or primitive development phases — they only affect the endgame.

#### GAP 7: Cross-Engine Perspective — LOW PRIORITY

**Current state:** Purely V8-focused.

**Why it matters:** RET2 Systems covers both V8 and JavaScriptCore. Understanding that exploitation techniques are engine-specific provides broader perspective.

**Recommendation:** Out of scope for a V8 module. Mention in the module description that JSC and SpiderMonkey have analogous but different compilation and exploitation patterns.

---

## 4. Quality Assessment

### Strengths

1. **Scaffolded bridge challenges** — The warmup/bridge/proof-lab pattern is pedagogically excellent. Students never face more than one new concept at a time. This exceeds what any commercial training offers.

2. **Dual CVE variants** — Each of the 5 CVEs has both an educational version (on a common V8 build with helpers) and a "real" version (on the original vulnerable V8 commit with different offsets). This forces students to demonstrate understanding rather than memorizing offsets.

3. **Complete infrastructure** — Every challenge has: patch, Dockerfile, tests (public + private), writeup, and module.yml entry. Build and test infrastructure is consistent.

4. **GC exploitation depth** — The 6f-warmup → 6g → 6h progression through garbage collection is unique. No other publicly available training covers GC-triggered UAF this thoroughly.

5. **Debugging challenges** — Levels 6i and 6j are unique in the industry. Teaching students to use `%DebugPrint()` and `%OptimizeFunctionOnNextCall()` as debugging tools rather than just exploitation aids is valuable.

6. **Volume and variety** — 50 challenges across 4 phases significantly exceeds any single commercial training course or CTF event.

### Weaknesses

1. **22 of 50 descriptions are generic** — 22 challenges use the description "Reference the included patch file to exploit the javascript engine!" instead of describing what the challenge teaches. This includes important challenges like level-1, level-2, level-4, level-5, level-7, and level-8. Students browsing the challenge list can't tell what these challenges teach without reading the patch.

   **Affected challenges:** level-1, level-1b, level-1c, level-2, level-2b, level-3, level-3b, level-4, level-5, level-6, level-6a, level-6b, level-6c, level-7, level-7a, level-7b, level-7c, level-7d, level-8, level-8a, level-8b, level-9

2. **Writeup quality varies** — Writeups range from 40 lines to 134 lines. Some writeups are detailed pedagogical guides; others are terse solution scripts. The bridge challenges generally have better documentation than the core levels.

3. **Single endgame technique for sandbox escape** — All sandbox escapes use WASM `memory_start` pivot. While this is well-taught, students graduate knowing only one sandbox escape primitive.

4. **No Maglev coverage** — See Gap 1. This is the most significant technical omission.

5. **BRIDGING_CHALLENGES_PLAN.md still in repo** — This planning document is still checked in. It's useful for maintainers but clutters the student-facing challenge directory.

### Infrastructure Quality

| Component | Status | Notes |
|-----------|--------|-------|
| `common/Dockerfile.j2` | Excellent | 2752-line multi-stage V8 builder, well-structured |
| `common/.init` | Good | Proper SUID setup, file permissions |
| `common/run` | Good | Clean execution wrapper |
| `common/catflag.c` | Good | Simple flag reader |
| `common/args.gn` | Good | Proper V8 build configuration |
| `module.yml` | Good | All 50 challenges listed with section headers |
| Public tests | Good | Consistent `console.log("ok")` pattern |
| Private tests | Excellent | Sophisticated multi-stage exploits with retry logic |
| Patch files | Excellent | Well-formed, apply cleanly to target V8 revisions |

---

## 5. Infrastructure Issues

### Issue 1: No Per-Challenge `challenge.yml`

Challenges rely solely on `module.yml` for metadata. There are no per-challenge `challenge.yml` files. This is consistent with the rest of the pwn.college repo but means all challenge metadata is centralized.

**Impact:** Low — the `module.yml` structure is clean and complete.

### Issue 2: Two V8 Build Epochs

Challenges use two different V8 revisions:
- Levels 1–6j use `5a2307d0` via `REVISION.j2` (references `common/REVISION`)
- Levels 7e–9d and most CVEs use `f5e412a1` via hardcoded `REVISION` files

This means students need two different V8 builds, which increases Docker image build time and disk usage. The separation is intentional (different V8 versions have different features/sandbox status), but it's not documented for students.

**Impact:** Medium — students may be confused by offset differences between challenge groups.

### Issue 3: Test Naming Inconsistency

Most challenges use `test_exploit.sh` for private tests. Exceptions:
- level-2 also has `test_solve.sh`
- level-3 uses `test_solve.sh` and `test_exhaustive.sh` instead of `test_exploit.sh`

**Impact:** Very low — all test files are properly executable and functional.

---

## 6. Comparison with Industry Training

### vs. RET2 Systems (5-day Browser Exploitation Training)

| Aspect | pwn.college | RET2 Systems |
|--------|-------------|-------------|
| Depth on V8 | Deeper (50 challenges) | Moderate (shared with JSC) |
| Cross-engine | V8 only | V8 + JavaScriptCore |
| CVE coverage | 5 CVEs, dual variants | Varies by year |
| Scaffolding | Excellent (bridge levels) | Good (instructor-guided) |
| Sandbox escape | WASM `memory_start` only | Multiple techniques |
| Maglev | Not covered | Covered (recent syllabi) |
| Vuln discovery | Not covered | Covered |
| Self-paced | Yes | No (live instruction) |

**Assessment:** pwn.college exceeds RET2 in V8-specific depth and scaffolding but lacks cross-engine perspective and modern sandbox techniques.

### vs. Exodus Intelligence (4-day Training)

| Aspect | pwn.college | Exodus Intelligence |
|--------|-------------|-------------------|
| Focus | Exploitation | Discovery + Exploitation |
| Depth | Very deep | Deep |
| CVEs | 5 historical | Current-year 0-days |
| Methodology | Given vuln → exploit | Find vuln → exploit |
| Maglev | Not covered | Covered (CVE-2024-0517) |

**Assessment:** Exodus's strength is vulnerability discovery methodology. pwn.college's strength is scaffolded exploitation learning. They're complementary rather than competitive.

### vs. Public CTF Challenges

| Aspect | pwn.college | Public CTFs |
|--------|-------------|-------------|
| Scaffolding | Excellent | None (standalone) |
| Volume | 50 challenges | 1–3 per CTF |
| Difficulty range | Beginner to expert | Usually expert-only |
| Documentation | Writeups for all | Post-CTF writeups only |
| Real CVEs | Yes | Rarely |

**Assessment:** pwn.college is dramatically superior to standalone CTF challenges for learning. CTF challenges (like *CTF 2019 OOB-V8 or Google CTF) are good supplementary exercises.

### vs. Google v8CTF

Google's ongoing v8CTF requires 80%+ reliability on current V8 builds. pwn.college challenges run on fixed V8 revisions and allow retries. The v8CTF is a testing ground for cutting-edge techniques; pwn.college is a learning environment. Both are valuable at different stages.

---

## 7. Recommendations (Prioritized)

### P0: Critical — Fix Before Next Semester

1. **Write descriptive descriptions for all 22 generic challenges.** Replace "Reference the included patch file to exploit the javascript engine!" with 1–2 sentences describing what each challenge teaches and what new technique it introduces. This is the single highest-impact improvement for student experience.

   Example improvements:
   - level-1: "Execute shellcode by converting a JavaScript double array into machine code via the custom `ArrayRun()` builtin."
   - level-4: "Use the custom `array.setLength()` Torque builtin to bypass bounds checking and achieve out-of-bounds access."
   - level-8: "Exploit a subtle integer overflow in TurboFan's bounds checking with only async GC available — no helper functions."

### P1: High Priority — Next Development Cycle

2. **Add Maglev compiler challenges (2–3 challenges).** This is the largest technical gap. Suggested:
   - `level-6k`: Maglev observation warmup — show how Maglev compilation differs from TurboFan, introduce `%GetOptimizationStatus()` Maglev flags
   - `cve-2024-0517` + `cve-2024-0517-real`: Maglev allocation folding OOB write
   - (Optional) `cve-2024-4947`: Maglev type confusion via AccessInfo

3. **Add modern sandbox escape challenges (2 challenges).** Diversify beyond WASM `memory_start`:
   - A challenge using Trusted Pointer Table corruption
   - A challenge extending level-9a's regexp bytecode concept to a complete sandbox escape chain

### P2: Medium Priority — Within 6 Months

4. **Add vulnerability discovery challenges (1–2 challenges).** Suggested:
   - "Patch analysis" challenge: given a V8 security commit, identify the vulnerability class and write a proof-of-concept trigger
   - "Variant analysis" challenge: given one OOB bug in simplified-lowering, find a related bug in nearby code

5. **Document the two-epoch V8 build system.** Add a note to `DESCRIPTION.md` or a new `ARCHITECTURE.md` explaining why levels 1–6j use a different V8 revision than levels 7e+, and what this means for offset differences.

6. **Clean up planning artifacts.** Remove or move `BRIDGING_CHALLENGES_PLAN.md` to a `docs/` or `.planning/` directory — it's useful for maintainers but clutters the student-facing directory.

### P3: Low Priority — Nice to Have

7. **Add a Sparkplug reference document.** Even without a dedicated challenge, a document explaining the full compilation pipeline (Ignition → Sparkplug → Maglev → TurboFan) would help students understand where each challenge's vulnerability sits.

8. **Add a Chrome process sandbox overview.** A reference document (not necessarily a challenge) explaining how V8 exploitation fits into a full Chrome exploit chain (renderer → Mojo → browser process).

9. **Consider adding reliability/determinism-focused challenges.** A challenge where the student must achieve >80% exploit reliability (inspired by v8CTF requirements) would be a good capstone for advanced students.

10. **Standardize test naming.** Rename level-3's `test_solve.sh` → `test_exploit.sh` for consistency (or document the naming convention).

---

## Appendix A: Challenge Descriptions Needing Improvement

The following 22 challenges use the generic description "Reference the included patch file to exploit the javascript engine!" and should be updated:

| Challenge | Suggested Description |
|-----------|----------------------|
| level-1 | Execute shellcode by converting a JavaScript double array into machine code via the custom `ArrayRun()` builtin. |
| level-1b | Navigate the V8 heap to find and corrupt a JSArrayBuffer's backing_store pointer, then pivot to shellcode execution. |
| level-1c | Build a ROP chain using a provided libc base address helper to achieve code execution without RWX memory. |
| level-2 | Construct arbitrary read/write primitives using `GetAddressOf()`, `ArbRead32()`, and `ArbWrite32()` helpers. |
| level-2b | Build a fake V8 object at a controlled memory address using `GetFakeObject()` combined with arbitrary read. |
| level-3 | Master the addrof/fakeobj primitive pair — the foundational V8 exploit technique — using only two helper functions. |
| level-3b | Achieve out-of-bounds access using address-guided heap search with minimal helper functions. |
| level-4 | Exploit a custom Torque-implemented `array.setLength()` builtin to bypass bounds checking and corrupt adjacent objects. |
| level-5 | Amplify a small off-by-one bug (via `array.offByOne()`) into a full arbitrary read/write primitive. |
| level-6 | Exploit a callback-based TOCTOU in `ArrayFunctionMap` where callbacks can modify array state during iteration. |
| level-6a | Combine JIT element-kind confusion with heap helpers for a guided introduction to JIT exploitation. |
| level-6b | Exploit JIT element-kind confusion with deterministic optimization but no heap navigation helpers. |
| level-6c | Trigger natural JIT compilation (no `%OptimizeFunctionOnNextCall`) and exploit element-kind confusion with `GetAddressOf`. |
| level-7 | Natural JIT warmup + blind heap capstone: no helpers, no deterministic optimization — full JIT exploitation from scratch. |
| level-7a | Use DataView out-of-bounds access (via JIT bounds bypass) to corrupt malloc heap structures with libc helper. |
| level-7b | Trigger synchronous GC to create unsorted bin chunks and leak libc addresses from freed backing stores. |
| level-7c | Achieve an unsorted bin libc leak using only async/non-deterministic garbage collection. |
| level-7d | Exploit a subtle integer overflow in bounds checking with synchronous GC for reliable heap manipulation. |
| level-8 | Full exploitation: subtle bounds bug + async GC + no helpers. Combines all techniques from levels 7-warmup through 7d. |
| level-8a | Introduction to V8 sandbox constraints: use WASM `memory_start` pivot with provided libc and offset helpers. |
| level-8b | Sandbox escape by finding d8 process base and WASM memory base without libc helper. |
| level-9 | Complete V8 sandbox escape with no helper functions — discover all addresses and build full exploit chain independently. |

---

## Appendix B: CVE Coverage Matrix

| CVE | Year | Bug Class | In Curriculum | Bridge Challenges |
|-----|------|-----------|---------------|-------------------|
| CVE-2021-21225 | 2021 | Callback re-entrancy (concat) | Yes (2 variants) | level-6d, level-6e |
| CVE-2020-6418 | 2020 | Side-effect modeling (TurboFan) | Yes (2 variants) | level-7e |
| CVE-2020-16040 | 2020 | Integer overflow (simplified lowering) | Yes (2 variants) | level-8c |
| CVE-2023-2033 | 2023 | WasmIndirectFunctionTable corruption | Yes (2 variants) | level-9a, level-9c |
| CVE-2024-2887 | 2024 | GSAB underflow (Pwn2Own) | Yes (2 variants) | level-9b, level-9d |
| CVE-2024-0517 | 2024 | Maglev allocation folding OOB | **NOT COVERED** | — |
| CVE-2024-4947 | 2024 | Maglev type confusion | **NOT COVERED** | — |
| CVE-2024-5274 | 2024 | Type confusion in V8 | **NOT COVERED** | — |
| CVE-2023-3079 | 2023 | Type confusion in V8 (ITW) | **NOT COVERED** | — |
| CVE-2023-4069 | 2023 | Type confusion in heap layout | **NOT COVERED** | — |

---

## Appendix C: Topic Coverage Heatmap

```
Topic                           Challenges  Depth
────────────────────────────    ──────────  ─────
Shellcode writing               ████░░░░░░  Good
V8 object model / maps          ██████████  Excellent
Pointer compression             ████████░░  Very Good
Addrof / Fakeobj                ████████░░  Very Good
OOB R/W primitives              ██████████  Excellent
JIT compilation (TurboFan)      ██████████  Excellent
JIT compilation (Maglev)        ░░░░░░░░░░  NOT COVERED
JIT compilation (Sparkplug)     ░░░░░░░░░░  NOT COVERED
GC exploitation                 ██████████  Excellent (unique)
UAF / unsorted bin              ████████░░  Very Good
Type confusion                  ██████░░░░  Good
Callback re-entrancy            ██████░░░░  Good
Sandbox escape (memory_start)   ████████░░  Very Good
Sandbox escape (other)          ██░░░░░░░░  Minimal
WASM exploitation               ██████░░░░  Good
Regexp bytecode                 ████░░░░░░  Intro only
BackingStore corruption         ██████░░░░  Good
ROP chains                      ████████░░  Very Good
V8 debugging                    ████░░░░░░  Good (unique)
Vuln discovery / fuzzing        ░░░░░░░░░░  NOT COVERED
Chrome process sandbox          ░░░░░░░░░░  NOT COVERED (out of scope)
CFI / CET bypass                ░░░░░░░░░░  NOT COVERED
```

---

## Summary

The V8 exploitation challenge suite is **production-quality and pedagogically excellent**, with 50 well-structured challenges covering the V8 exploitation lifecycle from shellcode basics through real-world CVE reproduction. Its scaffolded bridge challenges, dual CVE variants, and GC exploitation depth are industry-leading.

The three most impactful improvements would be:
1. **Descriptive challenge descriptions** (22 challenges need improvement) — immediate quality-of-life win
2. **Maglev compiler challenges** — fills the largest technical gap against the 2024–2025 threat landscape
3. **Modern sandbox escape diversity** — ensures students learn more than one escape technique

Overall assessment: **A / A+** — one of the most comprehensive V8 exploitation curricula available, with clear and addressable gaps.
