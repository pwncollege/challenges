name: V8 Exploitation
visibility: 
  start: "2024-08-01T17:00:00-07:00"
resources:
  - name: "Reference Material"
    type: markdown
    content: |
      - [V8 Developer Documentation](https://v8.dev)
      - [V8 Developer Documentation - The V8 Sandbox](https://v8.dev/blog/sandbox)
      - [Phrack V8 Case Study](http://www.phrack.org/issues/70/9.html#article)
  - name: "Debugging"
    type: markdown
    content: |
      V8 has a number of helpful runtime functions for debugging that can be activated with the `--allow-natives-syntax` flag. [Here](https://source.chromium.org/chromium/v8/v8.git/+/05720af2b09a18be5c41bbf224a58f3f0618f6be:src/runtime/runtime.h;l=574) is a list of them from V8's source code.

      `DebugPrint()` is particularly useful in inspecting an object's memory layout!

  - type: header
    content: V8 Heap Exploitation Primitives
  - id: level-1
    type: challenge
    name: "Level 1: Direct Shellcode Execution"
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-1a
    name: "Level 1a: Guided ArrayBuffer Layout Warmup"
    type: challenge
    description: Guided warmup: learn JSArrayBuffer backing_store layout before blind heap pivoting.
  - id: level-1b
    name: "Level 1b: Heap Navigation and BackingStore Pivot"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-1c
    name: "Level 1c: ROP Primer with Libc Helper"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-2
    name: "Level 2: Arbitrary Heap Read/Write Primitives"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-2b
    name: "Level 2b: Fake Object Construction with ArbRead32"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-3
    name: "Level 3: Fake Object via Addrof/Fakeobj"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-3b
    name: "Level 3b: OOB with Address-Guided Search"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-4
    name: "Level 4: setLength OOB Primitive"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-5
    name: "Level 5: Off-by-One to Full OOB"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-6
    name: "Level 6: Callback TOCTOU via functionMap"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-6e
    name: "Level 6e: WASM RWX Shellcode Primer"
    type: challenge
    description: "Bridge before CVE-2021-21225: learn WASM RWX shellcode execution in isolation with OOB + GetAddressOf helpers."
  - id: level-6d
    name: "Level 6d: Concat Fast-Path Re-Entrancy (Proof Lab)"
    type: challenge
    description: Bridge before CVE-2021-21225: isolate hole/prototype/valueOf re-entrancy and stale-length proof in concat fast paths.
  - id: cve-2021-21225
    name: cve-2021-21225
    type: challenge
    description: "CVE-2021-21225: Array.prototype.concat OOB via callback re-entrancy. Exploit a real-world vulnerability!"
  - id: cve-2021-21225-real
    name: cve-2021-21225-real
    type: challenge
    description: "CVE-2021-21225 on the original vulnerable V8 version. All offsets are different!"

  - type: header
    content: JIT Bugs on the V8 Heap
  - id: level-6-warmup
    name: "Level 6 Warmup: JIT Compilation Bridge"
    type: challenge
    description: JIT warmup bridge: deterministic optimization + element-kind confusion entry.
  - id: level-6a
    name: "Level 6a: Easy JIT + Easy Heap"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-6b
    name: "Level 6b: Deterministic JIT + Blind Heap"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-6c
    name: "Level 6c: Natural JIT Warmup + Addrof"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-7
    name: "Level 7: Natural JIT + Blind Heap Capstone"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-7e
    name: "Level 7e: Reflect.construct + Proxy Side-Effect (Placement Lab)"
    type: challenge
    description: Bridge before CVE-2020-6418: isolate Reflect.construct + Proxy trigger semantics and one-shot corruption placement.
  - id: cve-2020-6418
    name: cve-2020-6418
    type: challenge
    description: "CVE-2020-6418: Turbofan type confusion via incorrect side-effect modeling. A real 0-day exploited in the wild!"
  - id: cve-2020-6418-real
    name: cve-2020-6418-real
    type: challenge
    description: "CVE-2020-6418 on the original vulnerable V8 version. All offsets are different!"

  - type: header
    content: Maglev Compiler Exploitation
  - id: maglev-warmup
    name: "Maglev Warmup: Compilation Observation Lab"
    type: challenge
    description: "Observe Maglev's compilation tier: trigger Maglev and TurboFan independently, read optimization status flags, and contrast the two JIT compilers."
  - id: maglev-1
    name: "Maglev 1: Incomplete Object Initialization"
    type: challenge
    description: "Exploit Maglev's BuildAllocateFastObject missing element initialization to observe uninitialized double array contents."
  - id: maglev-2
    name: "Maglev 2: Allocation Folding Proof Lab"
    type: challenge
    description: "Prove that Maglev's allocation folding can span a GC boundary: demonstrate before/after value divergence when folded allocations are relocated."
  - id: maglev-3
    name: "Maglev 3: GC-Triggered OOB via Allocation Folding"
    type: challenge
    description: "Bridge before CVE-2024-0517: weaponize the allocation folding stale offset into a controlled OOB write and build exploit primitives."
  - id: cve-2024-0517
    name: cve-2024-0517
    type: challenge
    description: "CVE-2024-0517: Maglev allocation folding OOB write. Exploit the uncleared current_raw_allocation_ pointer across a GC boundary."
  - id: cve-2024-0517-real
    name: cve-2024-0517-real
    type: challenge
    description: "CVE-2024-0517 without helpers or native syntax. Pure exploitation from scratch!"
  - id: cve-2024-4947
    name: cve-2024-4947
    type: challenge
    description: "CVE-2024-4947: Maglev module namespace AccessInfo type confusion. A real 0-day exploited in the wild by the Lazarus Group!"

  - type: header
    content: Garbage Collection Internals
  - id: level-6f-warmup
    name: "Level 6f Warmup: GC Observation Lab"
    type: challenge
    description: "GC warmup: observe NewSpaceâ†’OldSpace promotion and WeakRef-based collection detection."
  - id: level-6g
    name: "Level 6g: GC-Triggered UAF (Proof Lab)"
    type: challenge
    description: "GC bridge: trigger garbage collection to free an ArrayBuffer backing store and read stale fd/bk pointers from the freed malloc chunk."
  - id: level-6h
    name: "Level 6h: GC Exploitation Capstone"
    type: challenge
    description: "GC capstone: full exploitation combining GC-triggered UAF with unsorted bin leak and libc ROP."

  - type: header
    content: V8 Debugging Challenges
  - id: level-6i
    name: "Level 6i: DebugPrint Offset Discovery"
    type: challenge
    description: "Debugging challenge: use %DebugPrint() and --allow-natives-syntax to discover randomized object offsets and hidden tokens."
  - id: level-6j
    name: "Level 6j: JIT Optimization Trace"
    type: challenge
    description: "Debugging challenge: use %OptimizeFunctionOnNextCall() and %GetOptimizationStatus() to control and verify Turbofan JIT compilation."

  - type: header
    content: JIT Bugs on the Malloc Heap
  - id: level-7-warmup
    name: "Level 7 Warmup: Malloc Heap BackingStore Primer"
    type: challenge
    description: Malloc heap bridge: DataView OOB and BackingStore deleter layout primer.
  - id: level-7a
    name: "Level 7a: DataView OOB with Libc Helper"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-7b
    name: "Level 7b: Unsorted Bin Leak with Synchronous GC"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-7c-warmup
    name: "Level 7c Warmup: Async-GC Reliability"
    type: challenge
    description: Reliability warmup: WeakRef/weak-callback state checks, GC progress control, and post-GC re-warm/yield patterns.
  - id: level-7c
    name: "Level 7c: Unsorted Bin Leak with Async GC"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-7d
    name: "Level 7d: Subtle Bounds Bug with Synchronous GC"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-8
    name: "Level 8: Subtle Bounds Bug with Async GC"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-8c
    name: "Level 8c: Typer Mismatch Arithmetic (Proof Lab)"
    type: challenge
    description: Bridge before CVE-2020-16040: prove typer prediction vs runtime value divergence on a small controlled arithmetic function.
  - id: cve-2020-16040
    name: cve-2020-16040
    type: challenge
    description: "CVE-2020-16040: Simplified lowering integer overflow bypasses typer hardening. Same file as level 8!"
  - id: cve-2020-16040-real
    name: cve-2020-16040-real
    type: challenge
    description: "CVE-2020-16040 on the original vulnerable V8 version. All offsets are different!"

  - type: header
    content: Escaping the V8 Sandbox
  - id: level-8-warmup
    name: "Level 8 Warmup: Sandbox + WASM Pivot Primer"
    type: challenge
    description: Sandbox bridge: guided WASM memory_start pivot before full sandbox escapes.
  - id: level-8a
    name: "Level 8a: Sandbox Introduction with Libc Helper"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-8b
    name: "Level 8b: Sandbox Pivot with D8 Base Helper"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-9
    name: "Level 9: Sandbox Escape Without Helpers"
    type: challenge
    description: Reference the included patch file to exploit the javascript engine!
  - id: level-9a
    name: "Level 9a: Regexp Bytecode Bridge"
    type: challenge
    description: Bridge challenge for regexp bytecode register corruption before CVE-2023-2033.
  - id: level-9c
    name: "Level 9c: Sandbox GOT-Overwrite Bridge"
    type: challenge
    description: Bridge before CVE-2023-2033: start from arb R/W and focus only on d8 base + GOT discovery and overwrite validation.
  - id: cve-2023-2033
    name: cve-2023-2033
    type: challenge
    description: "CVE-2023-2033: V8 sandbox escape via WasmIndirectFunctionTable raw pointer corruption. Exploited in the wild!"
  - id: cve-2023-2033-real
    name: cve-2023-2033-real
    type: challenge
    description: "CVE-2023-2033 on the original vulnerable V8 version. All offsets are different!"
  - id: level-9b
    name: "Level 9b: GSAB Underflow Bridge"
    type: challenge
    description: Bridge challenge for GSAB underflow read constraints before CVE-2024-2887.
  - id: level-9d
    name: "Level 9d: Wasm RWX Hunting / Jump-Table Patch Bridge"
    type: challenge
    description: Bridge before CVE-2024-2887: validate RWX candidates and redirect an indirect call target (jump-table style) without full CVE constraints.
  - id: cve-2024-2887
    name: cve-2024-2887
    type: challenge
    description: "CVE-2024-2887: Pwn2Own 2024 GSAB underflow sandbox escape. Full virtual address space R/W!"
  - id: cve-2024-2887-real
    name: cve-2024-2887-real
    type: challenge
    description: "CVE-2024-2887 on the original vulnerable V8 version. All offsets are different!"
