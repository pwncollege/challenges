diff --git a/src/compiler/simplified-lowering.cc b/src/compiler/simplified-lowering.cc
index 9435501..007bdb1 100644
--- a/src/compiler/simplified-lowering.cc
+++ b/src/compiler/simplified-lowering.cc
@@ -1535,7 +1535,7 @@ class RepresentationSelector {
     // the result type unless we deopt for -0 inputs.
     Type const restriction =
         truncation.IsUsedAsWord32()
-            ? Type::Any()
+            ? Type::Signed32()
             : (truncation.identify_zeros() == kIdentifyZeros)
                   ? Type::Signed32OrMinusZero()
                   : Type::Signed32();
@@ -1759,11 +1759,11 @@ class RepresentationSelector {
         if (lower<T>()) {
           if (index_type.IsNone() || length_type.IsNone() ||
               (index_type.Min() >= 0.0 &&
-               index_type.Max() < length_type.Min())) {
+               index_type.Max() < length_type.Max())) {
             // The bounds check is redundant if we already know that
             // the index is within the bounds of [0.0, length[.
             // TODO(neis): Move this into TypedOptimization?
-            new_flags |= CheckBoundsFlag::kAbortOnOutOfBounds;
+            DeferReplacement(node, NodeProperties::GetValueInput(node, 0));
           }
           ChangeOp(node,
                    simplified()->CheckedUint32Bounds(feedback, new_flags));
diff --git a/src/d8/d8.cc b/src/d8/d8.cc
index 050cbdc..6b3f98d 100644
--- a/src/d8/d8.cc
+++ b/src/d8/d8.cc
@@ -107,6 +107,27 @@ namespace {
 
 const int kMB = 1024 * 1024;
 
+void WinTyperMismatch(const v8::FunctionCallbackInfo<v8::Value>& info) {
+  v8::Isolate* isolate = info.GetIsolate();
+  if (info.Length() != 2) {
+    isolate->ThrowError("WinTyperMismatch(unoptimized, optimized): expected 2 values");
+    return;
+  }
+  if (!info[0]->IsUndefined()) {
+    isolate->ThrowError("WinTyperMismatch: expected unoptimized result to be undefined");
+    return;
+  }
+  if (!info[1]->IsNumber()) {
+    isolate->ThrowError("WinTyperMismatch: expected optimized result to be a number");
+    return;
+  }
+  (void)info[1].As<v8::Number>()->Value();
+  // On some builds, an unchecked read can materialize the FixedDoubleArray
+  // "hole" sentinel as a NaN double. That's still a typer mismatch
+  // (unopt: undefined, opt: number), so accept NaN here.
+  (void)system("/challenge/catflag");
+}
+
 #ifdef V8_FUZZILLI
 // REPRL = read-eval-print-reset-loop
 // These file descriptors are being opened when Fuzzilli uses fork & execve to
@@ -2860,7 +2882,9 @@ Local<FunctionTemplate> Shell::CreateNodeTemplates(Isolate* isolate) {
 
 Local<ObjectTemplate> Shell::CreateGlobalTemplate(Isolate* isolate) {
   Local<ObjectTemplate> global_template = ObjectTemplate::New(isolate);
-  global_template->Set(Symbol::GetToStringTag(isolate),
+  global_template->Set(isolate, "WinTyperMismatch",
+                       FunctionTemplate::New(isolate, WinTyperMismatch));
+/*  global_template->Set(Symbol::GetToStringTag(isolate),
                        String::NewFromUtf8Literal(isolate, "global"));
   global_template->Set(isolate, "version",
                        FunctionTemplate::New(isolate, Version));
@@ -2877,13 +2901,13 @@ Local<ObjectTemplate> Shell::CreateGlobalTemplate(Isolate* isolate) {
   global_template->Set(isolate, "readline",
                        FunctionTemplate::New(isolate, ReadLine));
   global_template->Set(isolate, "load",
-                       FunctionTemplate::New(isolate, ExecuteFile));
+                       FunctionTemplate::New(isolate, ExecuteFile));*/
   global_template->Set(isolate, "setTimeout",
                        FunctionTemplate::New(isolate, SetTimeout));
   // Some Emscripten-generated code tries to call 'quit', which in turn would
   // call C's exit(). This would lead to memory leaks, because there is no way
   // we can terminate cleanly then, so we need a way to hide 'quit'.
-  if (!options.omit_quit) {
+/*  if (!options.omit_quit) {
     global_template->Set(isolate, "quit", FunctionTemplate::New(isolate, Quit));
   }
   global_template->Set(isolate, "testRunner",
@@ -2909,7 +2933,7 @@ Local<ObjectTemplate> Shell::CreateGlobalTemplate(Isolate* isolate) {
   if (i::FLAG_expose_async_hooks) {
     global_template->Set(isolate, "async_hooks",
                          Shell::CreateAsyncHookTemplate(isolate));
-  }
+  }*/
 
   return global_template;
 }
